<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RIUHIN - Profil</title>
<style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; }
    header { padding:10px; background:#1da1f2; color:white; }
    .post { border-bottom:1px solid #ddd; padding:10px; }
</style>
</head>
<body>

<header>
    <h2>Profil</h2>
</header>

<div id="profileInfo" style="padding:10px;"></div>
<div id="postsContainer"></div>

<script>
    let currentUser = localStorage.getItem("currentUser");
    if (!currentUser) {
        document.body.innerHTML = `
            <div style="text-align:center; margin-top:50px; font-family:Arial;">
                <h2>Anda belum login</h2>
                <p>Silakan login terlebih dahulu untuk mengakses halaman ini.</p>
                <a href="login.html" style="display:inline-block; background:#1da1f2; color:white; padding:10px 20px; border-radius:5px; text-decoration:none;">Login</a>
            </div>
        `;
        throw new Error("Stop script karena belum login");
    }

    let viewUser = localStorage.getItem("viewProfile") || currentUser;
    document.getElementById("profileInfo").innerHTML = `
        <h3>${viewUser}</h3>
    `;

    function renderPosts() {
        let posts = JSON.parse(localStorage.getItem("posts") || "[]");
        let container = document.getElementById("postsContainer");
        container.innerHTML = "";
        posts.filter(p => p.username === viewUser).forEach((post, index) => {
            let div = document.createElement("div");
            div.className = "post";
            div.innerHTML = `
                <p>${post.content}</p>
                ${viewUser === currentUser ? `<button onclick="hapusPost(${index})">Hapus</button>` : ""}
            `;
            container.appendChild(div);
        });
    }

    function hapusPost(index) {
        let posts = JSON.parse(localStorage.getItem("posts") || "[]");
        let realIndex = posts.findIndex((p, i) => p.username === viewUser && i === index);
        if (realIndex !== -1) {
            posts.splice(realIndex, 1);
            localStorage.setItem("posts", JSON.stringify(posts));
            renderPosts();
        }
    }

    renderPosts();
</script>

</body>
</html>